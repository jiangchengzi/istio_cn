# 简介

本文档介绍了Istio，它是连接，管理和保护微服务的开放平台。 Istio提供了一种简单的方法，可以通过负载均衡，服务到服务身份验证，监控等来创建已部署服务的网络，而不需要对服务代码进行任何更改。您可以通过在整个环境中部署一个特殊的边缘代理来添加Istio对服务的支持，从而拦截使用Istio控制平面功能配置和管理的微服务之间的所有网络通信。

Istio目前仅支持Kubernetes上的服务部署，但将来版本中将支持其他环境。

#### 为什么要使用Istio

​Istio解决了从单片应用程序向分布式微服务架构转型过程中开发人员和运营商面临的许多挑战。**术语“服务网格”通常用于描述构成这些应用程序的微服务网络以及它们之间的交互**。随着服务网格的规模和复杂性的增长，它变得更难以理解和管理。其要求可以包括发现，负载平衡，故障恢复，指标和监控，以及通常更复杂的操作要求，如A / B测试，金丝雀版本升级，速率限制，访问控制和端到端认证。

​ Istio提供了一个完整的解决方案，通过为整个服务网格提供行为洞察和操作控制来满足微服务应用程序的多样化需求。它通过服务网络统一提供了许多关键功能：

* 交互管理：控制业务之间的流量和API调用流量，使得调用更可靠，并使网络在恶劣环境下更加健壮。

* 服务观察：了解服务之间的依赖关系以及它们之间的流量性质和流量，从而提供快速识别问题的能力。

* 策略执行：将组织策略应用于服务之间的互动，确保访问策略得到实施，资源在消费者之间得到公平的分配。通过配置网格而不是更改应用程序代码来进行策略更改。

* 身份认证和安全：在网格中提供具有可验证身份的服务，并提供在不同程度的可信度网络流动时保护服务流量的能力。

除了这些行为，Istio还设计用于扩展性，以满足不同的部署需求：

* 平台支持。 Istio旨在运行在各种环境中，包括跨云，内部部署，Kubernetes，Mesos等各种环境。我们最初专注于Kubernetes，但正在努力支持其他环境。

* 集成和自定义。可以扩展和定制策略实施组件，以与现有的ACL，日志记录，监控，配额，审计等解决方案集成。

这些功能大大减少了应用程序代码、底层平台和策略之间的耦合。这种减少的耦合不仅使服务更容易实现，而且使操作员在环境或新策略方案之间移动应用程序部署变得更简单。因此，应用程序本来就更容易携带。

#### 架构

Istio服务网格逻辑上分为数据平面和控制平面。

* **数据平面**由一组部署为边界的智能代理（Envoy）组成，可以介入和控制微服务之间的所有网络通信。

* **控制平面**负责管理和配置代理以路由流量，以及在运行时执行策略。

下图显示了构成每个平面的不同组件：

![](/assets/arch.png)

#### Envoy

​ Istio使用Envoy代理的扩展版本，该代理是以C ++开发的高性能代理，用于调解服务网格中所有服务的所有入站和出站流量。 Istio利用了Envoy的许多内置功能，例如动态服务发现，负载平衡，TLS终止，HTTP / 2＆gRPC代理，断路器，运行状况检查， %-based的流量分配，故障注入和丰富的指标的分阶段部署。

​ Envoy被部署为同一个Kubernetes pod中的相关服务的边界。这允许Istio将大量有关流量行为的信号作为属性提取出来，这些属性反过来可以在Mixer中用于执行策略决策，并发送到监视系统以提供有关整个网格的行为的信息。侧边代理模型还允许您将Istio功能添加到现有部署中，无需重新构建或重写代码。

#### Mixer

​ mixer负责在服务网格上执行访问控制和使用策略，并收集特使代理和其他服务的遥测数据。代理提取请求级属性，发送到mixer进行评估。mixer包括一个灵活的插件模型，使其能够与各种主机环境和基础设施后端接口，从这些细节中抽象出特使代理和Istio管理的服务。

#### Pilot

Pilot作为用户和Istio之间的接口，收集和验证配置并将其传播到各种Istio组件。它从Mixer和Envoy中抽取环境特定的实现细节，为他们提供独立于底层平台的用户服务的抽象表示。此外，流量管理规则（即通用层4规则和第七层HTTP / gRPC路由规则）可以在运行时通过Pilot进行编辑。

