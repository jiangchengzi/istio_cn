#### 概述

本页概述了Istio中流量管理的工作原理，包括流量管理原则的优点。它假设你已经阅读了《什么是Istio》并熟悉Istio的高级架构。您可以在本节其他指南中了解有关个人流量管理功能的更多信息。

#### Pilot and Envoy

用于Istio流量管理的核心组件是Pilot，它**管理和配置**部署在特定Istio服务网格中的所有Envoy代理实例。它允许您**指定**要用于在Envoy代理之间**路由流量的规则**，并**配置故障恢复功能**，如超时，重试和断路器。它还维护了网格中所有服务的规范模型，并使用它来通过其'服务发现'让Envoys了解网格中的其他实例。

每个Envoy实例根据其从Pilot获取的信息以及其负载平衡池中的其他实例的周期性健康检查来维护负载均衡信息，从而允许其在目标实例之间智能分配流量，同时遵循其指定的路由规则。

#### Traffic management benefits

使用Istio的流量管理模型，基本上将流量和基础设施扩展分解，让运营商通过Pilot指定他们希望流量遵循什么规则，而不是哪些特定的pod / VM应该接收流量 - pilot和envoy代理照顾其余的。因此，例如，您可以通过Pilot指定您希望特定服务的5％流量可以转到金丝雀版本，而不考虑金丝雀部署的大小，或根据请求的内容将流量发送到特定版本。

![](file:///Users/dengqiaoling/Accumulation/lstio/TrafficManagementOverview.svg?lastModify=1503107356)

将流量从基础架构扩展中解耦，这样就可以让Istio提供各种流量管理功能，这些功能不在应用程序代码之外。除了A / B测试的动态请求路由，逐步推出和canary版本之外，它还使用超时，重试和断路器处理故障恢复，最后还可以通过故障注入来测试服务之间故障恢复策略的兼容性。这些功能都是通过在服务网格中部署的特使侧面/代理来实现的。

